{% load static %}
<html class="no-js" lang="zxx">
<head>
    <title>Once | Create story</title>
    <meta name="theme-color" content="#141e30"/>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="true">
    <link rel="icon" href="">
    <link rel="stylesheet" href="{% static 'css/mdb.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/fontawesome-free.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/swiper.css' %}">
    <link rel="stylesheet" href="{% static 'css/emojionearea.min.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"
            integrity="sha256-0YPKAwZP7Mp3ALMRVB2i8GXeEndvCq3eSl/WsAl1Ryk="
			crossorigin="anonymous"></script>
    <script src="{% static 'js/mdb.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/swiper.min.js' %}"></script>
    <script src="{% static 'js/fontawesome.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/emojionearea.min.js' %}"></script>
    <style>
        #navbar .dropdown-menu{
            left: auto;
            right: 0;
        }

        .invisible{
            position: absolute;
            width: 0;
            height: 0;
            visibility: hidden;
        }
        .editableContainerAbsoluteContainer{
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .editable-container{
            position: relative;
            z-index: 5;
            border: none;
            transition: all 0.2s ease;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .new-editable-container{
            position: absolute;
            z-index: 99999;
        }
        .editable-container.active{
            border: 2px solid dodgerblue;
        }
        .resizeXbtn, .rotatebtn, .resizeXbtn:focus, .rotatebtn:focus{
            width: 10px;
            height: 10px;
            background: transparent;
            border: none;
            outline: none;
            position: absolute;
            transform: translate(-50%, -50%);
            border-radius: 50px;
            visibility: hidden;
        }
        .editable-container.active .resizeXbtn, .editable-container.active .resizeYbtn, .editable-container.active .rotatebtn{
            visibility: visible;
        }
        .resizeXbtn{
            top: 50%;
            left: 100%;
        }
        .rotatebtn{
            top: -10;
            left: 50%;
            width: 20px;
            height: 20px;
        }
        .resizeXbtn:not(:disabled){cursor: e-resize;}
        .storyContentControl{
            width: 35px;
            height: max-content;
            position: absolute;
            top: 50%;
            left: 100%;
            transform: translate(-70%, -50%);
            z-index: 6;
            visibility: hidden;
        }
        .storyControls{
            visibility: hidden;
        }
        .contentcard.active .storyContentControl, .contentcard.active .storyControls{
            visibility: visible;
        }
        .storyContentControl-navlink.nav-link{
            text-align: center;
            border-radius: 50px;
            width: 35px;
            height: 35px;
            background: dodgerblue;
            padding: 0;
            padding-top: 10px;
        }
        .card{
            height: 100%;
        }
        .v-center{
            display: table-cell;
            vertical-align: middle;
        }
        .text-bg{
            background: violet;
        }
        .includeText.active{
            border: 2px dashed dodgerblue;
        }
        .text-underlined{
            background: rgba(0, 0, 0, 0) linear-gradient(transparent 50%, rgb(182, 87, 108) 50%) repeat scroll 0% 0%;
        }
        .text-stroke{
            color: white;
            text-shadow: -1px -1px 0 grey, -1px 1px 0 grey, 1px -1px 0 grey, 1px 1px 0 grey;
        }
        .text-left-bordered{
            border-left: 2px solid #ffc107;
        }
        .specialTextColor{
            color: #ffc107;
        }
        .text-royal, .text-royal:hover{
            color: #323b51;
        }
        .btn-fancy{
            border-radius: 25px;
            width: 100px;
        }
        .btn-outline-white{
            width: 100%;
        }
        .dropdown-fancy.nav-link{
            width: 50px;
            height: 50px;
            border-radius: 50px;
            overflow: hidden;
            background: #323b51;
            color: white;
            font-weight: bold;
            text-align: center;
            line-height: 33px;
            box-shadow: 0px 0px 10px rgba(50, 59, 81, 0.5);
        }
        .half-bordered{
            border-right: 1px solid #323b51;
            border-left: 1px solid #323b51;
            height: max-content;
        }
        .bold{
            font-weight: bold;
        }
        .max-content{
            width: max-content;
        }
        .bg-royal{
            background: #323b51;
            color: white;
        }
        .bg-light-royal{
            background: #415586;
        }
        .image-fluid{
            max-width: 100%;
            max-height: 100%;
            display: block;
            margin: auto;
        }
        html{
            scroll-behavior: smooth;
        }
        body{
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
            overflow-x: hidden;
            background: #fefefe;
        }
        .section{
            padding: 30px;
        }

        #navbar{
            width: 100%;
            height: 60px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
        }

        #sidebar{
            width: 60px;
            height: calc(100% - 60px);
            position: fixed;
            top: 60px;
            left: 0;
            z-index: 9;
            padding-top: 20px;
            background: #03090b;
        }


        #sidebar .nav-item{
            padding: 10px;
        }

        #sidebar .nav-item .nav-link{
            height: 45px;
            display: block;
            color: white;
            border-radius: 10px;
            padding-top: 15px;
            transition: all 0.2s ease;
        }

        #sidebar .nav-item .nav-link:hover, #sidebar .nav-item .nav-link.active{
            background: white;
            color: #323b51;
        }

        #widgetbar{
            width: 350px;
            height: calc(100% - 60px);
            position: fixed;
            left: -100%;
            top: 60px;
            z-index: 8;
            background: #03090b;
            transition: all 0.2s ease;
            overflow-y: auto;
        }

        #content{
            width: calc(100% - 60px);
            height: calc(100% - 60px);
            position: fixed;
            top: 60px;
            left: 60px;
            transition: all 0.2s ease;
            overflow: auto;
            padding: 0;
        }
        .contentrow{
            display: inline-flex;
            width: auto;
            height: 100%;
            padding: 0;
        }
        .contentcard, .addStoryCard{
            width: 330px;
            height: 530px;
            position: relative;
        }
        .innerStoryCard{
            width: 100%;
            height: 100%;
            border: 2px solid grey;
            border-radius: 15px;
        }
        .contentcard.active{
            z-index: 10;
        }
        .contentcard.active .innerStoryCard{
            border: 3px solid dodgerblue;
        }
        .addStoryBtn{
            padding-top: 200px;
            cursor: pointer;
        }
        .addStoryBtn:hover{
            background: #f4f4f4;
        }
        .sticker-emoji-toggler.nav-link:hover, .sticker-emoji-toggler.nav-link.active{
            border-bottom: 3px solid white;
        }
        .imageUploaderLabel{
            width: 100%;
            height: 200px;
            border: 2px dashed white;
            cursor: pointer;
            padding-top: 90px;
        }
        .imageUploaderLabel:hover{
            background: #415586;
        }


        .clickmebtn{
			width: 100%;
			height: 50px;
			background: dodgerblue;
			border-radius: 25px;
			text-align: center;
			color: white;
			font-weight: bold;
			line-height: 50px;
            cursor: pointer;
		}

		.engage-card{
			background: white;
			border-radius: 10px;
		}

		.card-choice, .card-range-bar{
			background: lightgrey;
			border-radius: 3px;
			height: 30px;
		}

		.card-add-choice{
		    background: lightgrey;
			border-radius: 3px;
			height: 0;
			visibility: hidden;
		}

		.card-remove-choice{
		    line-height: 2;
		    visibility: hidden;
		}

		.editable-container.active .card-add-choice{
		    visibility: visible;
		    height: 30px;
		}
		.editable-container.active .card-remove-choice{
		    visibility: visible;
		}

		.card-choice-seq, .card-choice-check{
			background: white;
			height: 20px;
			width: 20px;
			border-radius: 50px;
			line-height: 20px;
			text-align: center;
			font-weight: bold;
		}

		.card-choice-check{
			border-radius: 2px;
		}



		.nav-yesno-answers{
			width: 100%;
			height: 60px;
			border-radius: 20px;
			background: white;
		}

		.nav-yesno-answers .nav-item{
			background: white;
			border: 1px solid grey;
			text-align: center;
			padding-top: 10px;
		}
		.nav-yesno-answers .nav-item:first-child{
			border-top-left-radius: 20px;
			border-bottom-left-radius: 20px;
		}
		.nav-yesno-answers .nav-item:nth-child(2){
			border-top-right-radius: 20px;
			border-bottom-right-radius: 20px;
		}


		.card-range-bar{
			height: 5px;
		}


		.hour-number-card{
			height: 40px;
			background: dodgerblue;
			border-radius: 3px;
			line-height: 40px;
			color: white;
			text-align: center;
			font-weight: bold;
		}

        .rangeSlider, .rangeSlider:focus{
            -webkit-appearance: none;
            width: 100%;
            height: 5px;
            border-radius: 5px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;

        }
		.rangeSlider::-webkit-slider-thumb {
            width: 20px;
            width: 20px;
            height: 50px;
            border: none;
            background: url('https://cdn.jsdelivr.net/emojione/assets/3.1/png/32/1f918.png');
		    background-repeat: no-repeat;
		    background-position: center;
        }

        .rangeSlider::-moz-range-thumb {
            width: 20px;
            width: 20px;
            height: 50px;
            border: none;
            background: url('https://cdn.jsdelivr.net/emojione/assets/3.1/png/32/1f918.png');
		    background-repeat: no-repeat;
		    background-position: center;
		}

        .shopProduct{
            height: auto; 
            width: 98%;
            margin: auto;
            background: rgba(225, 223, 223, 0.1);
            padding: 5px;
            border-radius: 5px;
        }
        .shopProduct.active{
            background: darkred;
        }


        .productCardWrapper{
            width: 310px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .productBuyCard{
            width: 100%;
            height: auto;
            margin: auto;
        }
        .productBuyCard .card-body{
            border-top-left-radius: 15px;
            box-shadow: 0px 0px 10px gray;
            border-top-right-radius: 15px;
        }
        .hiddenInput, .hiddenInput:focus{
            background: transparent;
            border: none;
            outline: none;
            text-align: center;
            width: 100%;
        }
        .changeQuantityBtn{
            width: 100%;
            height: 30px;
            border: 2px solid #333;
            border-radius: 25px;
            display: inline-block;
        }

    </style>
</head>
<body>

    <nav id="navbar" class="navbar navbar-expand justify-content-between navbar-light bg-light">
        <a href="{% url 'storiesList' %}" style="margin: 0; padding: 0px; height: 40px;" class="navbar-brand d-flex">
            <div class="d-flex" style="width: auto; height: 40px;">
                <img class="image-fluid" src="{% static 'img/logo.png' %}">
                <h4 class="bold text-royal p-2">ONCE</h4>
            </div>
        </a>
        <div class="d-flex justify-content-between" style="width: 100%;">
            <ul class="navbar-nav" style="padding-top: 8px;">
                <li class="nav-item" style="line-height: 1; padding-top: 10px; margin-left: 5px; margin-right: 5px;">
                    <a class="text-royal bold nav-link" href="#!">My Once story</a>
                </li>
                <li class="nav-item">
                    <a class="text-royal bold nav-link btn btn-fancy" href="#!">invite</a>
                </li>
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item" style="line-height: 3;">
                    <a class="nav-link text-royal bold" href="{% url 'answers' storySet %}">Answers</a>
                </li>
                <li class="nav-item m-md-2">
                    <a data-toggle="dropdown" class="text-royal btn btn-fancy bold nav-link" href="#!"><i class="fas fa-link"></i> Share</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item">
                            <div class="d-flex">
                                <input class="form-control" style="width: 100%;" type="text" id="previewLink" value="http://honkymonkey.com/preview/{{entireStorySet.code}}">
                                <a onclick="copyPreviewLink()" href="#!" class="btn btn-fancy"><i class="fas fa-copy"></i></a>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-2">
                    <a class="nav-link dropdown-fancy" data-toggle="dropdown">M</a>
                    <ul class="dropdown-menu p-1">
                        <li>
                            <a style="height: 30px;" class="nav-link text-royal d-flex justify-content-between" href="#">
                                Settings
                            </a>
                        </li>
                        <li>
                            <a style="height: 30px;" class="nav-link text-royal d-flex justify-content-between" href="#">
                                Logout
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>








    <ul id="sidebar" class="sidebar nav d-block" role="tablist">
        <li class="nav-item p-1">
            <a href="#text" data-toggle="tab" class="nav-link text-center bold widgetbarToggler">T</a>
        </li>
        <li class="nav-item p-1">
            <a href="#emoji" data-toggle="tab" class="nav-link text-center bold widgetbarToggler"><i class="far fa-surprise"></i></a>
        </li>
        <li class="nav-item p-1">
            <a href="#format" data-toggle="tab" class="nav-link text-center bold widgetbarToggler"><i class="fas fa-th-large"></i></a>
        </li>
        <li class="nav-item p-1">
            <a href="#image" data-toggle="tab" class="nav-link text-center bold widgetbarToggler"><i class="fas fa-image"></i></a>
        </li>
        <li class="nav-item p-1">
            <a href="#bolt" data-toggle="tab" class="nav-link text-center bold widgetbarToggler"><i class="fas fa-bolt"></i></a>
        </li>
        <li class="nav-item p-1">
            <a href="#cart" data-toggle="tab" class="nav-link text-center bold widgetbarToggler"><i class="fas fa-shopping-cart"></i></a>
        </li>
    </ul>
    <div id="widgetbar" class="tab-content">
        <div id="text" class="tab-pane p-2">
            <div class="row p-2">
                <div class="col-6 p-2">
                    <div data-type="text" class="widget d-table card pt-3 pb-3 bg-light-royal">
                        <h3 style="color: white; text-align:center;" class="v-center bold includeText">
                            MarkDown Simple Text
                        </h3>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="text" class="widget d-table card pt-3 pb-3 bg-light-royal">
                        <h3 style="color: white; text-align:center;" class="v-center bold text-bg includeText">
                            Text with background color
                        </h3>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="text" class="widget d-table card pt-3 pb-3 bg-light-royal">
                        <h3 style="color: white; text-align:center;" class="v-center bold">
                            <span class="text-underlined includeText">
                                Text with smart underline
                            </span>
                        </h3>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="text" class="widget d-table card pt-3 pb-3 bg-light-royal">
                        <h3 style="color: white; text-align:center;" class="v-center bold textStrokeContainer">
                            <span class="text-stroke includeText">
                                Transparent
                            </span>
                            <span class="includeText">
                                text with outline stroke
                            </span>

                        </h3>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="text" class="widget d-table card pt-3 pb-3 bg-light-royal">
                        <h5 style="color: white; text-align:center;" class="v-center bold text-left-bordered">
                            <span class="specialTextContainer includeText">We love </span><span class="specialTextColor includeText" style="color: #ffc107;">to</span>
                            <br/>
                            <span class="specialTextContainer includeText">Share </span><span class="specialTextColor includeText" style="color: #ffc107;">stories</span>
                            <br/>
                            <span class="specialTextContainer includeText">With </span><span class="specialTextColor includeText" style="color: #ffc107;">people</span>
                        </h5>
                    </div>
                </div>
            </div>
        </div>
        <div id="emoji" class="tab-pane p-2">
            <ul class="nav d-flex justify-content-center" role="tablist">
                <li class="nav-item">
                    <a data-toggle="tab" href="#stickers" class="nav-link text-white bold sticker-emoji-toggler active">Stickers</a>
                </li>
                <li class="nav-item">
                    <a data-toggle="tab" href="#emojis" class="nav-link text-white bold sticker-emoji-toggler">Emojis</a>
                </li>
            </ul>
            <div class="tab-content">
                <div id="stickers" class="tab-pane active p-2">
                    <input type="text" class="form-control" placeholder="Search stickers" name="seachstickers" id="seachstickers">
                    <div id="stickers-icons-container" class="row justify-content-between">
                        
                    </div>
                </div>
                <div id="emojis" class="tab-pane p-2">
                    <div id="emojis-icons-container"></div>
                </div>
            </div>
        </div>
        <div id="format" class="tab-pane p-2">
            <div class="row p-2">
                <div class="col-6 p-2">
                    <div data-type="block" class="widget card p-2 bg-light-royal">
                        <div>
                            <h6 class="text-white bold">
                                <i class="fas fa-check-circle"></i> <span class="includeText">Milk</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-check-circle"></i> <span class="includeText">Eggs</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-check-circle"></i> <span class="includeText">Tomatos</span>
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="block" class="card widget p-2 bg-light-royal">
                        <div>
                            <h6 class="text-white bold">
                                <i class="fas fa-dot-circle"></i> <span class="includeText">Milk</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-dot-circle"></i> <span class="includeText">Eggs</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-dot-circle"></i> <span class="includeText">Tomatos</span>
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="col-6 p-2">
                    <div data-type="block" class="card widget p-2 bg-light-royal">
                        <div>
                            <h6 class="text-white bold">
                                <i class="fas fa-circle"></i> <span class="includeText">Milk</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-circle"></i> <span class="includeText">Eggs</span>
                            </h6>
                            <h6 class="text-white bold">
                                <i class="fas fa-circle"></i> <span class="includeText">Tomatos</span>
                            </h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="image" class="tab-pane p-2">
            <ul class="nav d-flex justify-content-center" role="tablist">
                <li class="nav-item">
                    <a data-toggle="tab" href="#imageUpload" class="nav-link text-white bold sticker-emoji-toggler active">Images</a>
                </li>
                <li class="nav-item">
                    <a data-toggle="tab" href="#unsplash" class="nav-link text-white bold sticker-emoji-toggler">Unsplash</a>
                </li>
                <li class="nav-item">
                    <a data-toggle="tab" href="#giphy" class="nav-link text-white bold sticker-emoji-toggler">Gifs</a>
                </li>
            </ul>
            <div class="tab-content">
                <div id="imageUpload" class="tab-pane active p-2">
                    <form method="post" acction="">
                        <label for="imageUploaderInput" class="text-white text-center bold imageUploaderLabel">Browse and upload your image</label>
                        <input style="visibility: hidden;" type="file" id="imageUploaderInput" name="imageUploaderInput" onchange="uploadImage(this)">
                    </form>
                    <div class="row justify-content-between imagesContainer">
                        {% for image in images %}
                            <div class="col-6 p-2">
                                <div id="image_{{image.id}}" style="height: 100%;" data-type="image" class="widget card pt-3 pb-3 bg-light-royal">
                                    <img class="image-fluid" src="{{image.image.url}}">
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div id="unsplash" class="tab-pane p-2">
                    <input type="text" class="form-control" placeholder="Search images" name="searchimages" id="searchimages">
                    <div id="unsplash-icons-container" class="row justify-content-between">

                    </div>
                </div>
                <div id="giphy" class="tab-pane p-2">
                    <input type="text" class="form-control" placeholder="Search gifs" name="searchgifs" id="searchgifs">
                    <div id="gifs-icons-container" class="row justify-content-between">

                    </div>
                </div>
            </div>
        </div>
        <div id="bolt" class="tab-pane">
            <div class="row justify-content-center p-3 mx-auto" style="width: 100%;">
                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="button">
                        <div class="clickmebtn includeText">Click me !</div>
                    </div>
                </div>


                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="radio">
                        <div class="engage-card p-3">
                            <h6 class="text-center text-dark bold includeText">Make a choice:</h6>
                            <div class="choices">
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-seq m-1">1</div>
                                        <div class="card-choice-title m-1 includeText">First choice</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-seq m-1">2</div>
                                        <div class="card-choice-title m-1 includeText">Second choice</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-seq m-1">3</div>
                                        <div class="card-choice-title m-1 includeText">Third choice</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                            </div>
                            <div class="card-add-choice d-flex m-1">
                                <div style="cursor: pointer;" onclick="addChoice(this)" class="card-choice-title mx-auto"><i class="fas fa-plus"></i> Add choice</div>
                            </div>
                        </div>
                    </div>
                </div>




                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="check">
                        <div class="engage-card p-3">
                            <h6 class="text-center text-dark bold includeText">What animals do you like</h6>
                            <div class="choices">
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-check m-1"></div>
                                        <div class="card-choice-title m-1 includeText">Dogs</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-check m-1"></div>
                                        <div class="card-choice-title m-1 includeText">Cats</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                                <div class="card-choice d-flex justify-content-between pr-2 m-1">
                                    <div class="d-flex">
                                        <div class="card-choice-check m-1"></div>
                                        <div class="card-choice-title m-1 includeText">Fish</div>
                                    </div>
                                    <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                </div>
                            </div>
                            <div class="card-add-choice d-flex m-1">
                                <div style="cursor: pointer;" onclick="addChoice(this)" class="card-choice-title mx-auto"><i class="fas fa-plus"></i> Add choice</div>
                            </div>
                        </div>
                    </div>
                </div>




                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="yesNo">
                        <div class="p-3">
                            <h6 class="text-center text-white bold includeText">Is it stunny today?</h6>
                            <div class="nav nav-yesno-answers d-flex m-1 p-2">
                                <li class="nav-item col-6 text-info bold">Yes</li>
                                <li class="nav-item col-6 text-danger bold">No</li>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="range">
                        <div class="engage-card p-3">
                            <h6 class="text-center text-dark bold includeText">Once</h6>
                            <input class="rangeSlider" type="range">
                        </div>
                    </div>
                </div>




                <div class="col-10 mx-auto p-2">
                    <div class="widget" data-type="timer">
                        <div class="engage-card p-3">
                            <h6 class="text-center text-dark bold includeText">24h chrono</h6>
                            <div class="row justify-content-between timer-card">
                                <div class="col-3" style="padding: 0;">
                                    <div class="d-flex justify-content-center">
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">1</h6>
                                        </div>
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">0</h6>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <small class="text-muted">Days</small>
                                    </div>
                                </div>
                                <div class="col-3" style="padding: 0;">
                                    <div class="d-flex justify-content-center">
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">2</h6>
                                        </div>
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">4</h6>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <small class="text-muted">Hours</small>
                                    </div>
                                </div>
                                <div class="col-3" style="padding: 0;">
                                    <div class="d-flex justify-content-center">
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">5</h6>
                                        </div>
                                        <div class="col-6 p-1">
                                            <h6 class="hour-number-card">9</h6>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <small class="text-muted">Minutes</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="cart" class="tab-pane">
            {% if plan %}
                <div class="p-2 m-2">
                    <button type="button" data-toggle="modal" data-target="#connectShopModal" class="btn btn-outline-white">Update shop info</button>
                </div>
            	<div id="shopProductsList" class="p-3">

                </div>
            {% else %}
                <div class="p-3">
                    <div class="badge badge-warning"><h6 class="bold text-dark pt-1"><i class="fas fa-gem"></i> Premium</h6></div>
                    <br/>
                    <h3 class="text-white bold">Connect your shopify store and start selling</h3>
                    <br/>
                    <h6 class="text-white">By connecting your store, we'll pull all your products automatically so you can start selling directly through your Once Experience.</h6>
                    <br/>
                    <button type="button" data-toggle="modal" data-target="#connectShopModal" class="btn btn-outline-white">Upgrade Now</button>
                    <hr style="background: grey;">
                    <small class="text-muted">All your products will be pulled here</small>
                    <div class="mt-3">
                        <div class="pt-2 pb-2">
                            <div class="d-flex justify-content-between" style="height: 60px;width: 98%;margin: auto;background: rgba(225, 223, 223, 0.1);padding: 5px;border-radius: 5px;">
                            <div class="d-table" style="width: 50px; height: 50px; border-radius: 5px; background: violet; text-align: center;">
                                <h2 class="v-center"><i class="fas fa-tshirt"></i></h2>
                            </div>
                            <div class="d-block" style="height: 50px; width: 160px;">
                                <div style="width: 100%; height: 4px; border-radius: 5px; background: grey; margin-top: 10px;"></div>
                                <div style="width: 50%; height: 4px; border-radius: 5px; background: grey; margin-top: 10px;"></div>
                            </div>
                            <div class="d-table" style="height: 50px;">
                                <h6 class="v-center text-muted"><i class="fas fa-square"></i> <i class="fas fa-square"></i></h6>
                            </div>
                            <div class="d-table" style="height: 50px;">
                                <h6 class="v-center text-muted"><i class="fas fa-dollar-sign"></i></h6>
                            </div>
                        </div>
                        </div>
                        <div class="pt-2 pb-2">
                            <div class="d-flex justify-content-between" style="height: 60px;width: 98%;margin: auto;background: rgba(225, 223, 223, 0.1);padding: 5px;border-radius: 5px;">
                            <div class="d-table" style="width: 50px; height: 50px; border-radius: 5px; background: coral; text-align: center;">
                                <h2 class="v-center"><i class="fas fa-basketball-ball"></i></h2>
                            </div>
                            <div class="d-block" style="height: 50px; width: 160px;">
                                <div style="width: 100%; height: 4px; border-radius: 5px; background: grey; margin-top: 10px;"></div>
                                <div style="width: 50%; height: 4px; border-radius: 5px; background: grey; margin-top: 10px;"></div>
                            </div>
                            <div class="d-table" style="height: 50px;">
                                <h6 class="v-center text-muted"><i class="fas fa-square"></i> <i class="fas fa-square"></i></h6>
                            </div>
                            <div class="d-table" style="height: 50px;">
                                <h6 class="v-center text-muted"><i class="fas fa-dollar-sign"></i></h6>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>






    <div id="content" class="section">
        <div class="p-2 contentrow">
            <div class="p-2 addStoryCard">
                <div class="addStoryBtn innerStoryCard" onclick="addStory()"><h3 class="text-royal text-center bold"><i class="fas fa-plus"></i></h3></div>
            </div>
            {% for story in stories %}
                <div id="story_{{story.id}}" class="contentcard p-2">
                    <div class="innerStoryCard" style="position: relative; overflow:hidden; background: {{story.background}};">
                        {% for component in story.components.all %}
                            <div class="editableContainerAbsoluteContainer">
                                <div id="{{component.type}}_{{component.id}}" style="width: {{component.width}}; height: {{component.height}}; top: {{component.top}}; left: {{component.left}}; font-family: {{component.fontFamily}}; transform: translate(-50%, -50%) rotate({{component.rotation}});" class="editable-container">
                                    {% if component.type == 'image' %}
                                        <img class="image-fluid" src="{{component.image.url}}" alt="">
                                    {% elif component.type == 'text' or component.type == 'block' %}
                                        {% autoescape off %}
                                            {{component.html}}
                                        {% endautoescape %}
                                    {% elif component.type == 'range' %}
                                        <div style="background: {{component.background}};" class="engage-card p-3">
                                            <h6 style="color: {{component.color}};" class="text-center bold includeText">{{component.title}}</h6>
                                            <input class="rangeSlider" type="range">
                                        </div>
                                    {% elif component.type == 'yesNo' %}
                                        <div class="p-3">
                                            <h6 style="color: {{component.color}};" class="text-center bold includeText">{{component.title}}</h6>
                                            <div style="background: {{component.background}}" class="nav nav-yesno-answers d-flex m-1 p-2">
                                                <li class="nav-item col-6 text-info bold">Yes</li>
                                                <li class="nav-item col-6 text-danger bold">No</li>
                                            </div>
                                        </div>
                                    {% elif component.type == 'timer' %}
                                        <div style="background: {{component.background}};" class="engage-card p-3">
                                            <h6 style="color: {{component.color}};" class="text-center bold includeText">{{component.title}}</h6>
                                            <div class="row justify-content-between timer-card">
                                                <div class="col-3" style="padding: 0;">
                                                    <div class="d-flex justify-content-center">
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getD1}}</h6>
                                                        </div>
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getD2}}</h6>
                                                        </div>
                                                    </div>
                                                    <div class="text-center">
                                                        <small class="text-muted">Days</small>
                                                    </div>
                                                </div>
                                                <div class="col-3" style="padding: 0;">
                                                    <div class="d-flex justify-content-center">
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getH1}}</h6>
                                                        </div>
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getH2}}</h6>
                                                        </div>
                                                    </div>
                                                    <div class="text-center">
                                                        <small class="text-muted">Hours</small>
                                                    </div>
                                                </div>
                                                <div class="col-3" style="padding: 0;">
                                                    <div class="d-flex justify-content-center">
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getM1}}</h6>
                                                        </div>
                                                        <div class="col-6 p-1">
                                                            <h6 class="hour-number-card">{{component.getM2}}</h6>
                                                        </div>
                                                    </div>
                                                    <div class="text-center">
                                                        <small class="text-muted">Minutes</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>                                        
                                    {% elif component.type == 'button' %}
                                        <div style="cursor: pointer; background: {{component.background}}; color: {{component.color}};" class="clickmebtn includeText">Click me !</div>
                                    {% elif component.type == 'emoji' %}
                                        <img class="emojioneemoji" src="{{component.src}}" alt="">
                                    {% elif component.type == 'sticker' or component.type == 'gif' %}
                                        <figure>
                                            <img class="image-fluid" src="{{component.src}}" alt="">
                                        </figure>
                                    {% elif component.type == 'unsalpsh' %}
                                        <img class="image-fluid" src="{{component.src}}" alt="">
                                    {% elif component.type == 'check' %}
                                        <div style="background: {{component.background}};" class="engage-card p-3">
                                            <h6 style="color: {{component.color}};" class="text-center bold includeText">{{component.title}}</h6>
                                            <div class="choices">
                                                {% for choice in component.choices.all %}
                                                    <div id="choice_{{choice.id}}" class="card-choice d-flex justify-content-between pr-2 m-1">
                                                        <div class="d-flex">
                                                            <div class="card-choice-check m-1"></div>
                                                            <div class="card-choice-title m-1 includeText">{{choice.title}}</div>
                                                        </div>
                                                        <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                            <div class="card-add-choice d-flex m-1">
                                                <div style="cursor: pointer;" onclick="addChoice(this)" class="card-choice-title mx-auto"><i class="fas fa-plus"></i> Add choice</div>
                                            </div>
                                        </div>
                                    {% elif component.type == 'radio' %}
                                        <div style="background: {{component.background}};" class="engage-card p-3">
                                            <h6 style="color: {{component.color}};" class="text-center bold includeText">{{component.title}}</h6>
                                            <div class="choices">
                                                {% for choice in component.choices.all %}
                                                    <div id="choice_{{choice.id}}" class="card-choice d-flex justify-content-between pr-2 m-1">
                                                        <div class="d-flex">
                                                            <div class="card-choice-seq m-1">{{forloop.counter}}</div>
                                                            <div class="card-choice-title m-1 includeText">{{choice.title}}</div>
                                                        </div>
                                                        <h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                            <div class="card-add-choice d-flex m-1">
                                                <div style="cursor: pointer;" onclick="addChoice(this)" class="card-choice-title mx-auto"><i class="fas fa-plus"></i> Add choice</div>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <button class="resizeXbtn"><i class="fas fa-circle"></i></button>
                                </div>
                            </div>
                        {% endfor %}
                        {% if story.storyType == "checkout" %}
                            <div class="editableContainerAbsoluteContainer" style="padding: 10px; padding-top: 100px; width: 100%; overflow: hidden;">
                                <div class="card productBuyCard">
                                    <div class="card-image-top" style="width: 100%; height: 100px;">
                                        <img class="image-fluid" src="{{entireStorySet.src}}">
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="text-dark" style="font-weight: bold;">{{entireStorySet.title}}</h5>
                                            <h5 class="text-dark" style="font-weight: bold;">{{entireStorySet.price}}$</h5>
                                        </div>
                                        <div class="d-flex justify-content-between">
                                            <div class="col-4 text-center">
                                                <a onclick="changeQuantity('minus')" class="changeQuantityBtn">-</a>
                                            </div>
                                            <div class="col-4">
                                                <input class="hiddenInput disabled" type="text" name="quantity" id="quantity" value="1">
                                            </div>
                                            <div class="col-4 text-center">
                                                <a onclick="changeQuantity('plus')" class="changeQuantityBtn">+</a>
                                            </div>
                                        </div>
                                        <div style="width: 100%; margin-top: 10px;">
                                            <button class="text-center text-white" style="background: dodgerblue; width: 100%; height: 40px; border: none; border-radius: 5px;">Buy Now</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <ul class="nav d-block storyContentControl storyContentControl-oneColor">
                        <li class="nav-item">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center; line-height: 1;" href="#!"><i class="fas fa-palette"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <ul class="nav d-block p-2">
                                        <ul class="nav row" style="width: max-content">
                                            <small class="text-muted">set text color</small>
                                            <br/>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="white"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="black"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="grey"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="blue"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="cyan"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="purple"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="violet"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="lightblue"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="red"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="green"></a>
                                            </li>
                                        </ul>
                                        <hr>
                                        <ul class="nav row" style="width: max-content">
                                            <small class="text-muted">Set layout color</small>
                                            <br/>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="255,255,255" data-color="white"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="0,0,0" data-color="black"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="128,128,128" data-color="grey"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="0,0,255" data-color="blue"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="0,255,255" data-color="cyan"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="128, 0, 128" data-color="purple"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="238,130,238" data-color="violet"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="173, 216, 230" data-color="lightblue"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="255,0,0" data-color="red"></a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-rgb="0,255,0" data-color="green"></a>
                                            </li>
                                        </ul>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-clock"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <label for="timerDate" class="text-info">Date <small class="text-muted">MM/DD/YYYY</small></label>
                                    <input class="form-control" type="date" onchange="setTimerDate(this)" name="timerDate" id="timerDate">
                                    <hr>
                                    <label for="timerTimer" class="text-info">Time <small class="text-muted">HH:MM (AM/PM)</small></label>
                                    <input class="form-control" type="time" onchange="setTimerTime(this)" name="timerTime" id="timerTimer">
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-align-center"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <ul class="nav d-flex justify-content-between" style="width: max-content;">
                                        <li class="nav-item">
                                            <a onclick="setTextAlign(this)" data-align="left" href="#!" class="nav-link btn text-info"><i class="fas fa-align-left"></i></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setTextAlign(this)" data-align="center" href="#!" class="nav-link btn text-info"><i class="fas fa-align-center"></i></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setTextAlign(this)" data-align="right" href="#!" class="nav-link btn text-info"><i class="fas fa-align-right"></i></a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-quote-left"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <small class="text-muted">Enter text</small>
                                    <div class="d-block">
                                        <input onkeyup="setText(this)" style="border: none; border-bottom: 2px solid dodgerblue; width: 100%;" placeholder="Your text" type="text">
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-link"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <div class="form-group">
                                            <input id="setLinkTargetChecker" type="checkbox" onclick="setLinkTarget(this)">
                                            <label for="setLinkTargetChecker" class="text-info">
                                                Open link in new tab on click ?
                                            </label>
                                        </div>
                                    <small class="text-muted">Enter URL</small>
                                    <div class="d-block">
                                        <input onkeyup="setHref(this)" style="border: none; border-bottom: 2px solid dodgerblue; width: 100%;" placeholder="Your url" type="text">
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-font"></i></a>
                            <ul class="dropdown-menu" style="width: max-content;">
                                <li class="nav-item p-3">
                                    <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: Georgia, serif;' data-font="Georgia, serif">Nice mood under moon light</a>
                                </li>
                                <li class="nav-item p-3">
                                    <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: Arial, Helvetica, sans-serif;' data-font="Arial, Helvetica, sans-serif">Nice mood under moon light</a>
                                </li>
                                <li class="nav-item p-3">
                                    <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: "Comic Sans MS", cursive, sans-serif;' data-font='"Comic Sans MS", cursive, sans-serif'>Nice mood under moon light</a>
                                </li>
                                <li class="nav-item p-3">
                                    <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: "Courier New", Courier, monospace;' data-font='"Courier New", Courier, monospace'>Nice mood under moon light</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-sync-alt"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <input type="range" onmousemove="setRotationDegree(this)" class="form-control">
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-text-width"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item p-3">
                                    <input type="range" onmousemove="setFontSize(this)" class="form-control">
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item pt-1">
                            <a onclick="removeEditableContainer()" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-trash"></i></a>
                        </li>
                    </ul>
                    <ul class="storyControls nav d-flex justify-content-between">
                        <li class="nav-item">
                            <a onclick="removeStory(this)" href="#!" class="nav-link"><i class="fas fa-trash"></i></a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="dropdown" class="nav-link"><i class="fas fa-circle"></i></a>
                            <ul class="dropdown-menu p-3">
                                <li class="nav-item">
                                    <ul class="nav row p-2" style="width: 100%;">
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="white"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="black"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="grey"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="blue"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="cyan"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="purple"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="violet"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="lightblue"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="red"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="green"></a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="nav-item">
                                    <smal class="text-muted">Pre-made gradients</smal>
                                    <ul class="nav row p-2" style="width: 100%;">
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, white, grey)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, black, grey)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, blue, violet)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, green, yellow)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, red, darkred)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, dodgerblue, green)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, violet, red)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, green, cyan)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, white, cyan)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, pink, violet)"></a>
                                        </li>
                                        <li class="nav-item">
                                            <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, pink, red)"></a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            {% endfor %}
        </div>
    </div>


    <div id="imageCardHtml" style="visibility: hidden; width: 0; height: 0; position: absolute;">
        <div class="col-6 p-2">
            <div style="height: 100%;" class="widget newImageWidget card pt-3 pb-3 bg-light-royal">
                <img class="image-fluid" src="">
            </div>
        </div>
    </div>

    <div id="storyCardHtml" style="visibility: hidden; width: 0; height: 0; position: absolute;">
        <div id="" class="contentcard newContentCard p-2">
            <div class="innerStoryCard" style="position: relative; overflow:hidden;"></div>
            <ul class="nav d-block storyContentControl storyContentControl-oneColor">
                <li class="nav-item">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center; line-height: 1;" href="#!"><i class="fas fa-palette"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <ul class="nav d-block p-2">
                                <ul class="nav row" style="width: max-content">
                                    <small class="text-muted">set text color</small>
                                    <br/>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="white"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="black"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="grey"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="blue"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="cyan"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="purple"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="violet"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="lightblue"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="red"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextColor(this)" class="nav-link datacolorBtn" href="#!" data-color="green"></a>
                                    </li>
                                </ul>
                                <hr>
                                <ul class="nav row" style="width: max-content">
                                    <small class="text-muted">Set layout color</small>
                                    <br/>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="white"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="black"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="grey"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="blue"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="cyan"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="purple"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="violet"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="lightblue"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="red"></a>
                                    </li>
                                    <li class="nav-item">
                                        <a onclick="setTextSecondaryColor(this)" class="nav-link datacolorBtn" href="#!" data-color="green"></a>
                                    </li>
                                </ul>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-align-center"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <ul class="nav d-flex justify-content-between" style="width: max-content;">
                                <li class="nav-item">
                                    <a onclick="setTextAlign(this)" data-align="left" href="#!" class="nav-link btn text-info"><i class="fas fa-align-left"></i></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setTextAlign(this)" data-align="center" href="#!" class="nav-link btn text-info"><i class="fas fa-align-center"></i></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setTextAlign(this)" data-align="right" href="#!" class="nav-link btn text-info"><i class="fas fa-align-right"></i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-quote-left"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <small class="text-muted">Enter text</small>
                            <div class="d-block">
                                <input onkeyup="setText(this)" style="border: none; border-bottom: 2px solid dodgerblue; width: 100%;" placeholder="Your text" type="text">
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-link"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <small class="text-muted">Enter URL</small>
                            <div class="d-block">
                                <input onkeyup="setHref(this)" style="border: none; border-bottom: 2px solid dodgerblue; width: 100%;" placeholder="Your url" type="text">
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-font"></i></a>
                    <ul class="dropdown-menu" style="width: max-content;">
                        <li class="nav-item p-3">
                            <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: Georgia, serif;' data-font="Georgia, serif">Nice mood under moon light</a>
                        </li>
                        <li class="nav-item p-3">
                            <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: Arial, Helvetica, sans-serif;' data-font="Arial, Helvetica, sans-serif">Nice mood under moon light</a>
                        </li>
                        <li class="nav-item p-3">
                            <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: "Comic Sans MS", cursive, sans-serif;' data-font='"Comic Sans MS", cursive, sans-serif'>Nice mood under moon light</a>
                        </li>
                        <li class="nav-item p-3">
                            <a href="#!" onclick="setTextFont(this)" class="nav-link" style='font-family: "Courier New", Courier, monospace;' data-font='"Courier New", Courier, monospace'>Nice mood under moon light</a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-sync-alt"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <input type="range" onmousemove="setRotationDegree(this)" class="form-control">
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a data-toggle="dropdown" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-text-width"></i></a>
                    <ul class="dropdown-menu">
                        <li class="nav-item p-3">
                            <input type="range" onmousemove="setFontSize(this)" class="form-control">
                        </li>
                    </ul>
                </li>
                <li class="nav-item pt-1">
                    <a onclick="removeEditableContainer()" class="nav-link text-white storyContentControl-navlink" style="text-align: center;" href="#!"><i class="fas fa-trash"></i></a>
                </li>
            </ul>
            <ul class="storyControls nav d-flex justify-content-between">
                <li class="nav-item">
                    <a onclick="removeStory(this)" href="#!" class="nav-link"><i class="fas fa-trash"></i></a>
                </li>
                <li class="nav-item">
                    <a data-toggle="dropdown" class="nav-link"><i class="fas fa-circle"></i></a>
                    <ul class="dropdown-menu p-3">
                        <li class="nav-item">
                            <ul class="nav row p-2" style="width: 100%;">
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="white"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="black"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="grey"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="blue"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="cyan"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="purple"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="violet"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="lightblue"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="red"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="green"></a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <smal class="text-muted">Pre-made gradients</smal>
                            <ul class="nav row p-2" style="width: 100%;">
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, white, grey)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, black, grey)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, blue, violet)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, green, yellow)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, red, darkred)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, dodgerblue, green)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, violet, red)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, green, cyan)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, white, cyan)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, pink, violet)"></a>
                                </li>
                                <li class="nav-item">
                                    <a onclick="setStoryBg(this)" class="nav-link datacolorBtn" href="#!" data-color="linear-gradient(90deg, pink, red)"></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div id="connectShopModal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div style="width: 100px; height: 100px; margin: auto;">
                        <img class="image-fluid" src="{% static 'img/storeIcon.png' %}" alt="">
                    </div>
                    <br/>
                    {% if plan %}
                        <h2 class="text-center text-info">
                            Update your shop information
                        </h2>
                    {% else %}
                        <h2 class="text-center text-info">
                            Connect your E-Shop and pull your products automatically.
                        </h2>
                        <br/>
                        <div class="text-center">
                            <small class="text-danger bold">Create private app for you shop to generate API key and PASSWORD</small>
                        </div>
                    {% endif %}
                    <br/>
                    <form id="connectShopForm" method="post" {%if plan%}action="{% url 'updateShop' %}"{%else%}action="{% url 'connectShop' %}"{%endif%}>
                    {% csrf_token %}
                        <div class="form-group">
                            <label for="shopName" class="text-dark bold">Shop Domain*</label>
                            <input {%if plan%}value="{{customuser.shop_name}}"{%endif%} type="text" class="form-control" name="shopName" id="shopName" placeholder="shopname.myshopify.com (no paid domain, http or https)" required>
                        </div>
                        <div class="form-group">
                            <label for="shopKey" class="text-dark bold">Shop API Key*</label>
                            <input {%if plan%}value="{{customuser.shop_api_key}}"{%endif%} type="text" class="form-control" name="shopKey" id="shopKey" placeholder="Enter shop API Key" required>
                        </div>
                        <div class="form-group">
                            <label for="shopKey" class="text-dark bold">Shop password*</label>
                            <input {%if plan%}value="{{customuser.shop_password}}"{%endif%} type="password" class="form-control" name="shopPass" id="shopPass" placeholder="Enter shop password" required>
                        </div>
                        <button style="width: 100%;" type="submit" class="btn btn-warning">{%if plan%}Update{%else%}Connect{%endif%} shop</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <style>
        .emojionearea .emojionearea-picker.hidden{
            display: block;
            opacity: 1;
        }
        .emojionearea .emojionearea-picker{
            left: 0;
        }
        .emojionearea .emojionearea-picker.emojionearea-picker-position-top{
            margin-top: 20px;
        }
        .emojionearea .emojionearea-button, .emojionearea .emojionearea-editor{
            width: 0;
            height: 0;
            display: none;
            opacity: 0;
            visibility: hidden;
        }
        
    </style>
</body>
<script>



    function copyPreviewLink() {
        var copyText = document.getElementById("previewLink");

        copyText.select();
        copyText.setSelectionRange(0, 99999);

        document.execCommand("copy");
    }


    $(document).ready(function() {
        $("#emojis-icons-container").emojioneArea();
    });


    $("#seachstickers").on('keyup',function(e){
        e.preventDefault();
        url = "https://api.giphy.com/v1/stickers/search?api_key=G2hPbbatZMeld34WCsLQgjW2ket3qmtK&limit=50&q="+$("#seachstickers").val();
        document.getElementById('stickers-icons-container').innerHTML = '';
        fetch(url).then(response => response.json()).then(content => {
            var data = content.data;
            for(var i=0; i<data.length; i++){
                fig_widget_container_col = '<div id="new-giphy-widget" class="col-6 p-2"><div class="widget"></div></div>';
                fig_widget_container_col = document.createElement('div');
                fig_widget_container_col.className = "col-6 p-2";
                fig_widget_container = document.createElement('div');
                fig_widget_container.className = "widget";
                fig_widget_container.setAttribute('data-type','sticker');
                fig = document.createElement('figure');
                img = document.createElement('img')
                img.src = data[i].images.downsized.url;
                img.className = 'image-fluid';
                img.alt = '';
                fig.appendChild(img);
                fig_widget_container.appendChild(fig);
                fig_widget_container_col.appendChild(fig_widget_container);
                $("#stickers-icons-container").append(fig_widget_container_col);
            }
        }).catch(err =>{
            console.log(err);
        })
    });

     $("#searchgifs").on('keyup',function(e){
        e.preventDefault();
        url = "https://api.giphy.com/v1/gifs/search?api_key=G2hPbbatZMeld34WCsLQgjW2ket3qmtK&limit=50&q="+$("#searchgifs").val();
        document.getElementById('gifs-icons-container').innerHTML = '';
        fetch(url).then(response => response.json()).then(content => {
            var data = content.data;
            for(var i=0; i<data.length; i++){
                fig_widget_container_col = '<div id="new-giphy-widget" class="col-6 p-2"><div class="widget"></div></div>';
                fig_widget_container_col = document.createElement('div');
                fig_widget_container_col.className = "col-6 p-2";
                fig_widget_container = document.createElement('div');
                fig_widget_container.className = "widget";
                fig_widget_container.setAttribute('data-type','gif');
                fig = document.createElement('figure');
                img = document.createElement('img')
                img.src = data[i].images.downsized.url;
                img.className = 'image-fluid';
                img.alt = '';
                fig.appendChild(img);
                fig_widget_container.appendChild(fig);
                fig_widget_container_col.appendChild(fig_widget_container);
                $("#gifs-icons-container").append(fig_widget_container_col);
            }
        }).catch(err =>{
            console.log(err);
        })
    });

    $("#searchimages").on('keyup',function(e){
        e.preventDefault();
        url = "https://api.unsplash.com/search/photos/?client_id=ToG4VegydJru6-YnLZYBJEIpKnMCOLgS-YcoHqAEA4U&query="+$("#searchimages").val();
        document.getElementById('unsplash-icons-container').innerHTML = '';
        fetch(url).then(response => response.json()).then(content => {
            var data = content.results;
            for(var i=0; i<data.length; i++){
                fig_widget_container_col = '<div id="new-giphy-widget" class="col-6 p-2"><div class="widget"></div></div>';
                fig_widget_container_col = document.createElement('div');
                fig_widget_container_col.className = "col-6 p-2";
                fig_widget_container = document.createElement('div');
                fig_widget_container.className = "widget";
                fig_widget_container.setAttribute('data-type','unsplash');
                img = document.createElement('img')
                img.src = data[i].links.download;
                img.className = 'image-fluid';
                img.alt = '';
                fig_widget_container.appendChild(img);
                fig_widget_container_col.appendChild(fig_widget_container);
                $("#unsplash-icons-container").append(fig_widget_container_col);
            }
        }).catch(err =>{
            console.log(err);
        })
    });
    


    function uploadImage(input) {
        var file = $(input).prop("files")[0];
        var formdata = new FormData();
        formdata.append("images",file);

        $.ajax({
            type: "POST",
            url: "/upload_image/",
            data: formdata,
            contentType: false,
            processData: false,
            success: function(result) {
                result = eval(result)[0];
                var imageWidgetHtml = $("#imageCardHtml").html();
                $(".imagesContainer").append(imageWidgetHtml);
                $(".imagesContainer .newImageWidget img").attr('src',result['src']);
                $(".imagesContainer .newImageWidget").attr('id',"image_"+result['id']);
                $(".imagesContainer .newImageWidget").removeClass('newImageWidget');
                location.reload();
            }
        });
    }


    function setTextColor(obj){
        var color = $(obj).attr('data-color');
        $(".editable-container.active .includeText:not('.specialTextColor, .text-stroke, .card-choice-title')").css('color',color);
        var id = $(".editable-container.active").attr('id').split('_')[1];
        var editableContainerType = $(".editable-container.active").attr('id').split('_')[0];
        if(editableContainerType == "text" || editableContainerType == "block"){
            var type = "html";
            var data = $(".editable-container.active").html();
        }
        else{
            var type = "color";
            var data = color;
        }
        updateComponent(id, type, data);
    }

    function setTextSecondaryColor(obj){
        var color = $(obj).attr('data-color');
        var rgbColor = $(obj).attr('data-rgb');
        var undelineBG = 'rgba(0, 0, 0, 0) linear-gradient(transparent 50%, rgb('+rgbColor+') 50%)';
        $(".editable-container.active .text-bg").css('background',color);
        $(".editable-container.active .text-underlined").css('background',undelineBG);
        $(".editable-container.active .text-stroke").css({'text-shadow': '-1px -1px 0 '+color+', -1px 1px 0 '+color+', 1px -1px 0 '+color+', 1px 1px 0 '+color+''});
        $(".editable-container.active .specialTextColor").css({'color':color});
        $(".editable-container.active .text-left-bordered").css('border-color',color);
        $(".editable-container.active i").css('color',color);
        $(".editable-container.active .clickmebtn").css('background',color);
        $(".editable-container.active .engage-card").css('background',color);
        $(".editable-container.active .nav-yesno-answers").css('background',color);
        var id = $(".editable-container.active").attr('id').split('_')[1];
        var editableContainerType = $(".editable-container.active").attr('id').split('_')[0];
        if(editableContainerType == "text" || editableContainerType == "block"){
            var type = "html";
            var data = $(".editable-container.active").html();
        }
        else{
            var type = "background";
            var data = color;
        }
        updateComponent(id, type, data);
    }

    function setTextAlign(obj){
        var align = $(obj).attr('data-align');
        editableContainerType = $(".editable-container.active").attr('id').split('_')[0];
        if(editableContainerType == "text" || editableContainerType == "block"){
            $(".editable-container.active h3, .editable-container.active h5, .editable-container.active h6").css('text-align',align);
            var id = $(".editable-container.active").attr('id').split('_')[1];
            var type = "html";
            var data = $(".editable-container.active").html();
            updateComponent(id, type, data);
        }
    }

    function setTextFont(obj){
        var font = $(obj).attr('data-font');
        $(".editable-container.active").css('font-family',font);
        var id = $(".editable-container.active").attr('id').split('_')[1];
        var type = "fontFamily";
        updateComponent(id, type, font);
    }

    function setText(obj){
        var text = $(obj).val();
        $(".includeText.active").text(text);
        var updatingText = $(".includeText.active");
        if(updatingText.hasClass('card-choice-title')){
            var choice = updatingText.closest('.card-choice');
            var id = choice.attr('id').split('_')[1];
            var data = text;
            updateChoice(id, data);
        }
        else{
            var component = updatingText.closest('.editable-container');
            if(component.attr('id').split('_')[0] == "text" || component.attr('id').split('_')[0] == "block"){
                var data = component.html();
                var type = "html";
            }
            else{
                var data = text;
                var type = "title";
            }
            var id = component.attr('id').split('_')[1];
            updateComponent(id, type, data);
        }
    }

    function setHref(obj){
        if($(".editable-container.active").attr('id').split('_')[0] == "button"){
            var href = $(obj).val();
            var id = $(".editable-container.active").attr('id').split('_')[1];
            var type = "href";
            updateComponent(id, type, href);
        }
    }

    function setLinkTarget(obj){
        var id = $(".editabl-container.active").attr('id').split('_')[1];
        var type = "target"
        if($(obj).is(":checked")){
            updateComponent(id, type, "blank");
        }
        else{
            updateComponent(id, type, "None");
        }
    }

    function setRotationDegree(obj){
        degree = ($(obj).val() - 50) * 3.6;
        $(".editable-container.active").css('transform','translate(-50%, -50%) rotate('+degree+'deg)');
        var id = $(".editable-container.active").attr('id').split('_')[1];
        var type = "rotation";
        var finalDeg = degree+'deg';
        updateComponent(id, type, finalDeg);
    }

    function setFontSize(obj){
        size = $(obj).val();
        $(".editable-container.active .includeText").css('font-size',size);
        var id = $(".editable-container.active").attr('id').split('_')[1];
        var containerType = $(".editable-container.active").attr('id').split('_')[0];
        if(containerType == "text" || containerType == "block"){
            var data = $(".editable-container.active").html();
            updateComponent(id, "html", data);
        }
        else{
            updateComponent(id, "fontSize", size)
        }
    }


    $(document).ready(function(){
        $(".datacolorBtn").each(function(){
            $(this).css({'border':'2px solid black','margin':'3px','width':'30px','height':'30px','border-radius':'50px','background':$(this).attr('data-color')});
        });
    });


    $(document).on('click', '.widgetbarToggler', function(){
        if($(this).hasClass('activeToggler')){
            hideWidgetBar();
            $(this).removeClass('active');
            $(this).removeClass('activeToggler');
        }
        else{
            showWidgetBar();
            $(".widgetbarToggler").removeClass('activeToggler');
            $(this).addClass('activeToggler');
        }
    });

    function showWidgetBar(){
        $("#widgetbar").css({'left':'60px', 'box-shadow':'0px 0px 10px grey'});
    }
    function hideWidgetBar(){
        $("#widgetbar").css({'left':'-100%', 'box-shadow':'none'});
    }


    $(document).on('click','.contentcard',function(){
        $(".contentcard.active").removeClass('active');
        $(this).addClass('active');
    });



    $(document).on('click','.widget',function(e){
        var widget = $(this).html();
        var type = $(this).attr('data-type');

        var editableContainerAbsoluteContainer = document.createElement('div');
        editableContainerAbsoluteContainer.className = "editableContainerAbsoluteContainer";

        var editableContainer = document.createElement('div');
        editableContainer.className = "editable-container";

        var resizeButton = document.createElement('button');
        resizeButton.className = "resizeXbtn";

        var resizeBtnIcon = document.createElement('i');
        resizeBtnIcon.className = "fas fa-circle";

        resizeButton.appendChild(resizeBtnIcon);
        editableContainer.innerHTML = widget;
        editableContainer.appendChild(resizeButton);
        editableContainerAbsoluteContainer.appendChild(editableContainer);        


        $(".contentcard.active .innerStoryCard").append(editableContainerAbsoluteContainer);
        if(type == "image"){
            dataSrc = $(this).attr('id').split('_')[1];
            createComponent(type, dataSrc, editableContainer);
        }
        else if(type == "sticker" || type == "gif"){
            dataSrc = $(this)[0].children[0].children[0].src;
            createComponent(type, dataSrc, editableContainer);
        }
        else if(type == "unsplash"){
            dataSrc = $(this)[0].children[0].src;
            createComponent(type, dataSrc, editableContainer);
        }
        else if(type == "text" || type == "block"){
            createComponent(type, widget, editableContainer);
        }
        else{
            createComponent(type, null, editableContainer);
        }

    });

    $(document).on('click','.emojibtn',function(){
        var dataSrc = $(this)[0].children[0].src;
        var widget = $(this).html();
        var type = "emoji";

        var editableContainerAbsoluteContainer = document.createElement('div');
        editableContainerAbsoluteContainer.className = "editableContainerAbsoluteContainer";

        var editableContainer = document.createElement('div');
        editableContainer.className = "editable-container";

        var resizeButton = document.createElement('button');
        resizeButton.className = "resizeXbtn";

        var resizeBtnIcon = document.createElement('i');
        resizeBtnIcon.className = "fas fa-circle";

        resizeButton.appendChild(resizeBtnIcon);
        editableContainer.innerHTML = widget;
        editableContainer.appendChild(resizeButton);
        editableContainerAbsoluteContainer.appendChild(editableContainer);


        $(".contentcard.active .innerStoryCard").append(editableContainerAbsoluteContainer);
        createComponent(type, dataSrc, editableContainer);
    });



    $(document).on('click','.editable-container',function(){
        $(".editable-container.active").removeClass('active');
        $(this).addClass('active');
        if ($(".editable-container.active .specialTextContainer").length > 0){
            $(".threeInuptSpecialTextCase").removeClass("invisible");
        }
        else{
            $(".threeInuptSpecialTextCase").addClass("invisible");
        }
    });


    $(document).on('mousedown','.editable-container',function(e){
        e.preventDefault();
        e.stopPropagation();
        $(this).draggable({
            stop: function () {
                var l = $(".editable-container.active").css('left');
                var t = $(".editable-container.active").css('top');
                var id = $(".editable-container.active").attr('id').split('_')[1];
                updateComponent(id, "top", t);
                updateComponent(id, "left", l);
            }
        });
    });

    $(document).on('mousedown','.resizeXbtn',function(e){
        e.stopPropagation();
        var elementWidth = $(".editable-container.active").width();
        var xpos = $(this).offset().left;
        resizeXclicking = true;
        $(document).on('mousemove',function(e){
            if (resizeXclicking == true){
                var newxpos = e.pageX;
                var widthDifference = newxpos - xpos;
                $(".editable-container.active").css('width',elementWidth+widthDifference);
                var finalWidth = elementWidth+widthDifference;
                var id = $(".editable-container.active").attr('id').split('_')[1];
                var type = "width";
                updateComponent(id, type, finalWidth);
            }
        });
        $(document).on('mouseup',function(){
            resizeXclicking = false;
        });
    });


    function setStoryBg(obj){
        $(".contentcard.active .innerStoryCard").css('background',$(obj).attr('data-color'));
        updateStory($(obj).attr('data-color'));
    }

    

    function getTimerDate(){
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0');
        var yyyy = today.getFullYear();

        var first = mm + "/" + dd + "/" + yyyy;
        var second = $("#timerDate").val().split("-");
        
        second = second[1] + "/" + second[2] + "/" + second[0];

        first = new Date(first);
        second = new Date(second);

        var Difference_In_Time = second.getTime() - first.getTime(); 
        var Difference_In_Days = Difference_In_Time / (1000 * 3600 * 24);
  
        console.log(Difference_In_Days);
    }

    function getTimerTime(){
        var today = new Date();
        var hours = today.getHours();
        var minutes = today.getMinutes();

        console.log(hours+":"+minutes);
        console.log($("#timerTimer").val());
    }

    function setTimerTime(obj){
        var time = $(obj).val().split(':');
        var hours = time[0];
        var minutes = time[1];
        var editableContainerType = $(".editable-container.active").attr('id').split('_')[0];
        if(editableContainerType == "timer"){
            var id = $(".editable-container.active").attr('id').split('_')[1];
            updateComponent(id, "hours", hours);
            updateComponent(id, "minutes", minutes);
        }
    }


    function setTimerDate(obj){
        var date = $(obj).val();
        var editableContainerType = $(".editable-container.active").attr('id').split('_')[0];
        if(editableContainerType == "timer"){
            var id = $(".editable-container.active").attr('id').split('_')[1];
            updateComponent(id, "date", date);
        }
    }

    var x = setInterval(adjustTimer,60000);

    function adjustTimer(){
        $(".timer-card").each(function(){
            var d1 = $(this).find('.hour-number-card')[0];
            var d2 = $(this).find('.hour-number-card')[1];
            var h1 = $(this).find('.hour-number-card')[2];
            var h2 = $(this).find('.hour-number-card')[3];
            var m1 = $(this).find('.hour-number-card')[4];
            var m2 = $(this).find('.hour-number-card')[5];

            if (Number(m2.textContent) > 0){
                m2.textContent = Number(m2.textContent) - 1;
            }
            else if(Number(m2.textContent) == 0){
                if(Number(m1.textContent) > 0){
                    m2.textContent = 9;
                    m1.textContent = Number(m1.textContent) - 1;
                }
                else if(Number(m1.textContent) == 0){
                    m2.textContent = 9;
                    m1.textContent = 5;
                    if(Number(h2.textContent) > 0){
                        h2.textContent = Number(h2.textContent) - 1;
                    }
                    else if(Number(h2.textContent) == 0){
                        if(Number(h1.textContent) > 0){
                            h2.textContent = 9;
                            h1.textContent = Number(h1.textContent) - 1;
                        }
                        else if(Number(h1.textContent) == 0){
                            h2.textContent = 4;
                            h1.textContent = 2;
                            if(Number(d2.textContent) > 0){
                                d2.textContent = Number(d2.textContent) - 1;
                            }
                            else if(Number(d2.textContent) == 0){
                                if(Number(d1.textContent) > 0){
                                    d2.textContent = 9;
                                    d1.textContent = Number(d1.textContent) - 1;
                                }
                            }
                        }
                    }
                }
            }

        });
    }
    

    
        


   












    var storySet = "{{storySet}}";


    function addStory(){
        $.ajax({
             type: "POST",
             url: "/create_story/"+storySet+"/",
             data: null,
             contentType: false,
             processData: false,
             success: function(result) {
                 $(".contentrow").append($("#storyCardHtml").html());
                 $(".contentrow .newContentCard").attr('id','story_'+result);
                 $(".contentrow .newContentCard").removeClass("newContentCard");
             }
        });
    }

    function updateStory(bg){
        var id = $(".contentcard.active").attr('id').split('_')[1];
        var url = '/update_story/'+id+'/'+bg+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (data) {
                null;
            }
        });
    }

    function removeStory(obj){
        var id = $(".contentcard.active").attr('id').split('_')[1];

        var url = '/remove_story/'+id+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (data) {
                null;
            }
        });
        $(obj).closest('.contentcard').remove();
    }









    function createComponent(type, data, element){
        var id = $(".contentcard.active").attr('id').split('_')[1];
        var url = '/createComponent/'+id+'/'+type+'/';

        $.ajax({
            type: "POST",
            url: url,
            data: {'data': data},
            success: function (result) {
                if(type == "text" || type == "block" || type == "image" || type == "yesNo" || type == "timer" || type == "range" || type == "button" || type == "emoji" || type == "sticker" || type == "unsplash" || type == "gif"){
                    element.setAttribute('id',type+"_"+result);
                }
                else{
                    element.setAttribute('id',type+"_"+result['component_id']);
                    element.children[0].children[1].children[0].setAttribute('id',"choice_"+result['choice_1_id']);
                    element.children[0].children[1].children[1].setAttribute('id',"choice_"+result['choice_2_id']);
                    element.children[0].children[1].children[2].setAttribute('id',"choice_"+result['choice_3_id']);
                }
            }
        });
    }




    function updateComponent(id, type, data){
        var url = '/updateComponent/'+id+'/'+type+'/';
        $.ajax({
            type: "POST",
            url: url,
            data: {'data': data},
            success: function (result) {
                console.log(result);
            }
        });
    }



    $(document).on('click', '.includeText', function(e){
        $(".includeText.active").removeClass('active');
        $(this).addClass('active');
    });





    function removeEditableContainer(){
        var objId = $(".editable-container.active").attr('id').split('_')[1];
        var url = '/removeEditableContainer/'+objId+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (result) {
                null;
            }
        });
        $(".editable-container.active").remove();
    }


    function addChoice(obj){
        var component = $(obj).closest('.editable-container');
        var objId = component.attr('id').split('_')[1];
        var url = '/addChoice/'+objId+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (result) {
                if (component.attr('id').split('_')[0] == "check"){
                    component[0].firstElementChild.children[1].innerHTML += '<div id="choice_'+result+'" class="card-choice d-flex justify-content-between pr-2 m-1"><div class="d-flex"><div class="card-choice-check m-1"></div><div class="card-choice-title m-1 includeText">New choice</div></div><h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6></div>';
                }
                else if (component.attr('id').split('_')[0] == "radio"){
                    component[0].firstElementChild.children[1].innerHTML += '<div id="choice_'+result+'" class="card-choice d-flex justify-content-between pr-2 m-1"><div class="d-flex"><div class="card-choice-seq m-1">'+component[0].firstElementChild.children[1].children.length+'</div><div class="card-choice-title m-1 includeText">New choice</div></div><h6 style="cursor: pointer;" onclick="removeChoice(this)" class="text-danger card-remove-choice bold">&times;</h6></div>';
                }
            }
        });
    }


    function updateChoice(id, data){
        var url = '/updateChoice/'+id+'/'+data+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (result) {
                null;
            }
        });
    }

    function removeChoice(obj){
        var choice = $(obj).closest('.card-choice');
        var objId = choice.attr('id').split('_')[1];
        var url = '/removeChoice/'+objId+'/';
        $.ajax({
            type: "GET",
            url: url,
            data: null,
            success: function (result) {
                null;
            }
        });
        choice.remove();
    }

</script>

{% if plan %}
    <script>
        $(document).ready(function(e){
            var data = {{products|safe}}.products;
            console.log(data);
            for(var i=0; i<data.length; i++){
                var productsContainer = document.getElementById('shopProductsList');

                var topPaddingContainer = document.createElement('div');
                topPaddingContainer.className = "pt-2 pb-2";

                var displayFlexContainer = document.createElement('div');
                if("{{entireStorySet.product}}" == data[i].id){
                    displayFlexContainer.className = "d-flex justify-content-between shopProduct active";
                }
                else{
                    displayFlexContainer.className = "d-flex justify-content-between shopProduct";
                }
                
                displayFlexContainer.setAttribute('data-id',data[i].id);
                displayFlexContainer.setAttribute('data-price',data[i].variants[0].price);
                displayFlexContainer.setAttribute('data-title',data[i].title);
                displayFlexContainer.setAttribute('data-src',data[i].image.src);
                displayFlexContainer.setAttribute('data-handle', data[i].handle);


                // sibling 1
                var productImageContainer = document.createElement('div');
                productImageContainer.className = "d-table";
                productImageContainer.setAttribute('style','width: 50px; height: 50px; border-radius: 5px; background: white;');

                var productImage = document.createElement('img');
                productImage.src = data[i].image.src;
                productImage.className = "image-fluid";

                productImageContainer.appendChild(productImage);


                // sibling 2
                var productDes = document.createElement('div');
                productDes.className = "d-block";
                productDes.setAttribute('style','height: 50px; width: 160px;');

                productTitle = document.createElement('div');
                productTitle.setAttribute('style','font-size:10px');
                productTitle.className = "text-white bold";
                productTitle.innerHTML = data[i].title;

                productDes.appendChild(productTitle);


                // sibling 3
                productPriceCon = document.createElement('div');
                productPriceCon.className = "d-table";
                productPriceCon.setAttribute('style','height: 50px;');

                productPrice = document.createElement('h6');
                productPrice.className = "v-center text-muted";
                productPrice.innerHTML = data[i].variants[0].price+' <i class="fas fa-dollar-sign"></i>';


                productPriceCon.appendChild(productPrice);


                displayFlexContainer.appendChild(productImageContainer);
                displayFlexContainer.appendChild(productDes);
                displayFlexContainer.appendChild(productPriceCon);

                topPaddingContainer.appendChild(displayFlexContainer);
                if("{{entireStorySet.product}}" == data[i].id){
                    productsContainer.prepend(topPaddingContainer);
                }
                else{
                    productsContainer.appendChild(topPaddingContainer);
                }
                


            }
        });

        $(document).on('click', '.shopProduct', function(){
            $(".shopProduct.active").removeClass('active');
            $(this).addClass('active');
            var id = $(this).attr('data-id');
            var handle = $(this).attr('data-handle')
            var title = $(this).attr('data-title');
            var price = $(this).attr('data-price');
            var src = $(this).attr('data-src');
            var url = "/addProductSell/{{storySet}}/";
            $.ajax({
                type: "POST",
                url: url,
                data: {
                    "handle": handle,
                    "title": title,
                    "price": price,
                    "src": src,
                    "id": id,
                },
                success: function (result) {
                    null;
                }
            });
        });

        

    </script>
{% endif %}
</html>
